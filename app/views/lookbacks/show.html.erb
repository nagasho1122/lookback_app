<% provide(:title, "振り返り") %>
<div class="container normal-page-container" id="normal-page-container">
  <%= form_with(model: @lookback, local: true ) do |f| %>
    <div class="form-lookback">
      <div class="school-inf-box">
      <div class="group">
        <%= f.number_field :year, min: 1980 , max: 2030, sep: 1, value: @lookback.year, 
        class: 'inputMaterial', id: "lookback_year",  :readonly => true %>
        <span class="highlight"></span>
        <span class="bar"></span>
        <%= f.label :year, "年度", class: "label" %>
      </div>
      
      <div class="group">
        <%= f.text_field :university, class: 'inputMaterial university-form', value: @lookback.university, :readonly => true %>
        <span class="highlight"></span>
        <span class="bar university-bar"></span>
        <%= f.label :university, "大学名", class: "label" %>
      </div>
      
      <div class="group inline-block">
        <%= f.text_field :faculty, class: 'inputMaterial faculty-form', value: @lookback.faculty, :readonly => true %>
        <span class="highlight"></span>
        <span class="bar"></span>
        <%= f.label :faculty, "学部", class: "label" %>
      </div>
      
      <div class="group inline-block department-group">
        <%= f.text_field :department, class: 'inputMaterial department-form', value: @lookback.department, :readonly => true %>
        <span class="highlight"></span>
        <span class="bar"></span>
        <%= f.label :department, "学科" , class: "label"%>
      </div>
    </div>
  <% end %>
  
    <% @subjects.each do |subject| %>    
      <div class="subject-card">
        <div class="subject-card-top show-subject">
            <%= subject.subject %>
        </div>
        <div class="subject-card-bottom">
          
          <div class="flex-container-detail">
            <% instance_variable_get("@lookback_details_#{subject.id}").each do |lookback_detail| %>
                <div class="lookback-detail-card">
                  <div class="lookback-detail-card-top">
                    <div class="number-word-left d-inline">大問：</div>
                      <%= lookback_detail.number %>
                  </div>
                  <div class="lookback-detail-card-bottom">
                    <div class="lookback-detail-card-bottom-formbox form-unit show-detail">
                      <%= lookback_detail.unit %>
                    </div>
                    <div class="lookback-detail-card-bottom-formbox form-lookback_word show-detail">
                      <%= lookback_detail.text %>
                    </div>
                  </div>
                </div>
            <% end %>
          </div>
          
          <div class="flex-container-review">
            <% instance_variable_get("@reviews_#{subject.id}").each do |review| %>
              <%= render "lookbacks/show_review", review: review %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
      
  <%= form_with(model: @lookback, local: true ) do |f| %>
    <div class="group">
      <%= f.text_area :all_text, class: 'inputMaterial-all_text all_text-form', value: @lookback.department, :readonly => true %>
      <span class="highlight"></span>
      <%= f.label :all_text, "全体振り返り", class: "label label-all_text" %>
    </div>
  <% end %>
  
</div>